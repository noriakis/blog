[
  {
    "path": "posts/2021-10-19-wcGeneSummary/",
    "title": "Using wcGeneSummary",
    "description": "Using wcGeneSummary",
    "author": [
      {
        "name": "noriakis",
        "url": {}
      }
    ],
    "date": "2021-10-20",
    "categories": [
      "R",
      "bioinformatics"
    ],
    "contents": "\r\nUsing wcGeneSummary\r\nI was searching for the method to annotate the gene cluster when the enrichment analysis did not return significant results. I found a recent package GeneSummary authored by Dr. Zuguang Gu. Using GeneSummary, wordcloud and tm, one can make wordcloud or correlation network of gene description and plot them.\r\n\r\n\r\n# devtools::install_github(\"noriakis/wcGeneSummary\")\r\nlibrary(wcGeneSummary)\r\nlibrary(org.Hs.eg.db)\r\nerccs <- c(\"ERCC1\",\"ERCC2\",\"ERCC3\",\"ERCC4\",\"ERCC5\",\"ERCC6\",\"ERCC8\")\r\nentrezID = AnnotationDbi::select(org.Hs.eg.db, keys = erccs, columns = c(\"ENTREZID\"), keytype = \"SYMBOL\")$ENTREZID\r\ngwc <- wcGeneSummary(entrezID, excludeFreq = 5000, max.words=200, random.order=FALSE,\r\n                     colors=palettetown::pokepal(150), shape=\"circle\", rot.per=0.4)\r\ngwc$wc\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-10-19-wcGeneSummary/distill-preview.png",
    "last_modified": "2021-10-22T13:42:58+09:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-09-10-mustread/",
    "title": "Must read - 2021",
    "description": "Must read articles related to bioinformatics, BK polyomavirus and DNA damage response.",
    "author": [
      {
        "name": "noriakis",
        "url": {}
      }
    ],
    "date": "2021-09-22",
    "categories": [
      "bioinformatics",
      "BK polyomavirus",
      "DNA damage response"
    ],
    "contents": "\r\nBK polyomavirus\r\nZhao L, Imperiale MJ. A Cell Culture Model of BK Polyomavirus Persistence, Genome Recombination, and Reactivation. MBio. 2021 Sep 2;e0235621. Available from: http://dx.doi.org/10.1128/mBio.02356-21\r\nSingle-cell\r\nAn P, Cantalupo PG, Zheng W, Sáenz-Robles MT, Duray AM, Weitz D, et al. Single-Cell Transcriptomics Reveals a Heterogeneous Cellular Response to BK Virus Infection. J Virol. 2021 Feb 24;95(6). Available from: http://dx.doi.org/10.1128/JVI.02237-20\r\nCarcinogenesis\r\nBaker SC, Mason AS, Slip RG, Skinner KT, Macdonald A, Masood O, et al. BK polyomavirus (BKPyV) is a risk factor for bladder cancer through induction of APOBEC3-mediated genomic damage. bioRxiv. 2021. p. 2021.05.13.443803. Available from: https://www.biorxiv.org/content/10.1101/2021.05.13.443803v1\r\nBioinformatics\r\nWu T, Hu E, Xu S, Chen M, Guo P, Dai Z, et al. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. Innov J. 2021 Jul 1;100141. Available from: https://www.sciencedirect.com/science/article/pii/S2666675821000667\r\nStone M, McCalla SG, Siahpirani AF, Periyasamy V, Shin J, Roy S. Identifying strengths and weaknesses of methods for computational network inference from single cell RNA-seq data. bioRxiv. 2021. p. 2021.06.01.446671. Available from: https://www.biorxiv.org/content/10.1101/2021.06.01.446671v1\r\nDNA damage response\r\nSchumacher B, Pothof J, Vijg J, Hoeijmakers JHJ. The central role of DNA damage in the ageing process. Nature. 2021 Apr;592(7856):695–703.\r\nGaragnani P, Marquis J, Delledonne M, Pirazzini C, Marasco E, Kwiatkowska KM, et al. Whole-genome sequencing analysis of semi-supercentenarians. Elife. 2021 May 4;10. Available from: http://dx.doi.org/10.7554/eLife.57849\r\nGeijer ME, Zhou D, Selvam K, Steurer B, Mukherjee C, Evers B, et al. Elongation factor ELOF1 drives transcription-coupled repair and prevents genome instability. Nat Cell Biol. 2021 Jun 9;23(6):608–19.\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-10-22T13:00:54+09:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-09-14-nephrologyj/",
    "title": "Using sjrdata to plot the metrics of nephrology-related journals",
    "description": "Using sjrdata to plot the metrics of nephrology-related journals",
    "author": [
      {
        "name": "noriakis",
        "url": {}
      }
    ],
    "date": "2021-09-15",
    "categories": [
      "R",
      "nephrology"
    ],
    "contents": "\nよく「あの頃の○○（ジャーナル名）に出したのは凄い！」みたいな話を聞く。出す雑誌だけでなく時期も大事なのか、何かしら分かりやすくまとめられないかと見ていると、Rのsjrdataという素晴らしいパッケージ・データセットを見つけたのでサンプルコードとggrepelを使ってプロットしてみた。\n\n\n# devtools::install_github(\"ikashnitsky/sjrdata\")\nlibrary(sjrdata)\nlibrary(tidyverse)\nlibrary(rmarkdown)\n# Check 'nephrology' and 'kidney'\nnephrology <- unique(sjr_journals[grep(\"nephrology\",\n                                       tolower(sjr_journals$title)),]$title)\nkidney <- unique(sjr_journals[grep(\"kidney\",\n                                   tolower(sjr_journals$title)),]$title)\npaged_table(as.tibble(c(nephrology, kidney)))\n\n\n\n\n{\"columns\":[{\"label\":[\"value\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Journal of the American Society of Nephrology : JASN\"},{\"1\":\"Seminars in Nephrology\"},{\"1\":\"Scandinavian Journal of Urology and Nephrology, Supplement\"},{\"1\":\"Current Opinion in Nephrology and Hypertension\"},{\"1\":\"Experimental Nephrology\"},{\"1\":\"Nephrology Dialysis Transplantation\"},{\"1\":\"Clinical Nephrology\"},{\"1\":\"Pediatric Nephrology\"},{\"1\":\"Journal of Nephrology\"},{\"1\":\"American Journal of Nephrology\"},{\"1\":\"Contributions to Nephrology\"},{\"1\":\"Advances in nephrology from the Necker Hospital\"},{\"1\":\"International Urology and Nephrology\"},{\"1\":\"Nephrology\"},{\"1\":\"Japanese Journal of Nephrology\"},{\"1\":\"Geriatric Nephrology and Urology\"},{\"1\":\"Nephrology Nursing Journal\"},{\"1\":\"Nephrology news &amp; issues\"},{\"1\":\"Clinical and Experimental Nephrology\"},{\"1\":\"Le Journal CANNT = CANNT journal : the journal of the Canadian Association of Nephrology Nurses and Technicians\"},{\"1\":\"Nephrology, Hemodialysis and Transplantation\"},{\"1\":\"BMC Nephrology\"},{\"1\":\"Journal of Nephrology, Urology and Transplantation\"},{\"1\":\"Hong Kong Journal of Nephrology\"},{\"1\":\"Nephron - Experimental Nephrology\"},{\"1\":\"Nephrology, Dialysis and Transplantation\"},{\"1\":\"Nature Reviews Nephrology\"},{\"1\":\"Clinical Journal of the American Society of Nephrology\"},{\"1\":\"Indian Journal of Nephrology\"},{\"1\":\"International Journal of Nephrology and Renovascular Disease\"},{\"1\":\"Arab journal of nephrology and transplantation\"},{\"1\":\"Open Urology and Nephrology Journal\"},{\"1\":\"Turkish Nephrology, Dialysis and Transplantation Journal\"},{\"1\":\"International Journal of Nephrology\"},{\"1\":\"Case Reports in Nephrology and Dialysis\"},{\"1\":\"Clinical Nephrology - Case Studies\"},{\"1\":\"Nephrology and Dialysis\"},{\"1\":\"Kidney International\"},{\"1\":\"American Journal of Kidney Diseases\"},{\"1\":\"Kidney International, Supplement\"},{\"1\":\"Kidney and Blood Pressure Research\"},{\"1\":\"Advances in Chronic Kidney Disease\"},{\"1\":\"Saudi journal of kidney diseases and transplantation : an official publication of the Saudi Center for Organ Transplantation, Saudi Arabia.\"},{\"1\":\"Iranian Journal of Kidney Diseases\"},{\"1\":\"CKJ: Clinical Kidney Journal\"},{\"1\":\"Kidney International Supplements\"},{\"1\":\"Kidney Research and Clinical Practice\"},{\"1\":\"Canadian Journal of Kidney Health and Disease\"},{\"1\":\"Kidney International Reports\"},{\"1\":\"Kidney Medicine\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  \n\n興味のある雑誌だけを抽出する。\n\n\ncandJournals <- c(nephrology[c(1,6,19,22,28)], kidney[c(1,2,8,12)])\npaged_table(as.tibble(candJournals))\n\n\n\n\n{\"columns\":[{\"label\":[\"value\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"Journal of the American Society of Nephrology : JASN\"},{\"1\":\"Nephrology Dialysis Transplantation\"},{\"1\":\"Clinical and Experimental Nephrology\"},{\"1\":\"BMC Nephrology\"},{\"1\":\"Clinical Journal of the American Society of Nephrology\"},{\"1\":\"Kidney International\"},{\"1\":\"American Journal of Kidney Diseases\"},{\"1\":\"CKJ: Clinical Kidney Journal\"},{\"1\":\"Kidney International Reports\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  \n\nlibrary(ggplot2)\nlibrary(ggrepel)\nsjr_journals %>%\n    filter(title %in% candJournals) %>%\n    ggplot(aes(cites_doc_2years, sjr, color = title,\n               label=year, fill=title))+\n    geom_point(size=4, alpha=0.8)+\n    stat_ellipse(geom=\"polygon\", alpha=0.1)+\n    theme_bw()+\n    geom_text_repel(aes(color = title),\n                    bg.color = \"black\",\n                    segment.color=\"black\", bg.r = .1)+\n    coord_cartesian(expand = T)+\n    theme(legend.position=\"bottom\")\n\n\n\n\nさすがに何がなんだか分からない。h-indexでも見てみる。\n\n\nsjr_journals %>%\n    filter(title %in% candJournals) %>%\n    ggplot(aes(h_index, sjr, color = title,\n               label=year, fill=title))+\n    geom_point(size=4, alpha=0.8)+\n    stat_ellipse(geom=\"polygon\", alpha=0.1)+\n    theme_bw()+\n    geom_text_repel(aes(color = title),\n                    bg.color = \"black\", segment.color=\"black\",\n                    bg.r = .1)+\n    coord_cartesian(expand = T)+\n    theme(legend.position=\"bottom\")+\n    guides(color=guide_legend(nrow=3, byrow=TRUE))\n\n\n\n\nらに絞ってみる。\n\n\nsjr_journals %>%\n    filter(title %in% candJournals[c(1,2,5,6,7)]) %>%\n    ggplot(aes(cites_doc_2years, sjr, color = title,\n               label=year, fill=title))+\n    geom_point(size=4, alpha=0.8)+\n    stat_ellipse(geom=\"polygon\", alpha=0.1)+\n    theme_bw()+\n    geom_text_repel(aes(color = title), bg.color = \"black\",\n                    segment.color=\"black\", bg.r = .1)+\n    coord_cartesian(expand = T)+\n    theme(legend.position=\"bottom\")+\n    guides(color=guide_legend(nrow=2, byrow=TRUE))\n\n\n\n\n中堅と思われるジャーナル。\n\n\nsjr_journals %>%\n    filter(title %in% candJournals[c(8,9)]) %>%\n    ggplot(aes(cites_doc_2years, sjr, color = title,\n               label=year, fill=title))+\n    geom_point(size=4, alpha=0.8)+\n    stat_ellipse(geom=\"polygon\", alpha=0.1)+\n    theme_bw()+\n    geom_text_repel(aes(color = title), bg.color = \"black\",\n                    segment.color=\"black\", bg.r = .1)+\n    coord_cartesian(expand = T)+\n    theme(legend.position=\"bottom\")\n\n\n\n\nさらに、その他のジャーナル。\n\n\nsjr_journals %>%\n    filter(title %in% candJournals[c(3,4)]) %>%\n    ggplot(aes(cites_doc_2years, sjr, color = title,\n               label=year, fill=title))+\n    geom_point(size=4, alpha=0.8)+\n    stat_ellipse(geom=\"polygon\", alpha=0.1)+\n    theme_bw()+\n    geom_text_repel(aes(color = title), bg.color = \"black\",\n                    segment.color=\"black\", bg.r = .1)+\n    coord_cartesian(expand = T)+\n    theme(legend.position=\"bottom\")\n\n\n\n\n\n\n\n",
    "preview": "posts/2021-09-14-nephrologyj/distill-preview.png",
    "last_modified": "2021-09-15T21:12:55+09:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-08-02-useful/",
    "title": "Useful links",
    "description": "Useful links",
    "author": [
      {
        "name": "noriakis",
        "url": {}
      }
    ],
    "date": "2021-08-02",
    "categories": [
      "others"
    ],
    "contents": "\nNote-bnlearn\nIntermittent and periodic fasting, longevity and disease\n\n\n\n",
    "preview": {},
    "last_modified": "2021-09-15T19:34:36+09:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-06-01-dmbn/",
    "title": "Bayesian network analysis of the re-admission of diabetes mellitus patients",
    "description": "Using bnlearn",
    "author": [
      {
        "name": "noriakis",
        "url": {}
      }
    ],
    "date": "2021-06-01",
    "categories": [
      "R"
    ],
    "contents": "\r\nBayesian network analysis to reason the re-admission of diabetes mellitus patients. The used dataset is from the paper: Strack B, DeShazo JP, Gennings C, Olmo JL, Ventura S, Cios KJ, et al. Impact of HbA1c measurement on hospital readmission rates: analysis of 70,000 clinical database patient records. Biomed Res Int. 2014 Apr 3;2014:781670. https://doi.org/10.1155/2014/781670\r\n\r\n\r\nlibrary(bnlearn)\r\nlibrary(tidyverse)\r\nlibrary(bnviewer)\r\nlibrary(parallel)\r\nlibrary(igraph)\r\nlibrary(ggraph)\r\n\r\ndf <- read.table(\"diabetic_data_initial.csv\", sep=\",\", header=1)\r\ndim(df)\r\n\r\n\r\n[1] 101766     50\r\n\r\ncolnames(df)\r\n\r\n\r\n [1] \"encounter_id\"             \"patient_nbr\"             \r\n [3] \"race\"                     \"gender\"                  \r\n [5] \"age\"                      \"weight\"                  \r\n [7] \"admission_type_id\"        \"discharge_disposition_id\"\r\n [9] \"admission_source_id\"      \"time_in_hospital\"        \r\n[11] \"payer_code\"               \"medical_specialty\"       \r\n[13] \"num_lab_procedures\"       \"num_procedures\"          \r\n[15] \"num_medications\"          \"number_outpatient\"       \r\n[17] \"number_emergency\"         \"number_inpatient\"        \r\n[19] \"diag_1\"                   \"diag_2\"                  \r\n[21] \"diag_3\"                   \"number_diagnoses\"        \r\n[23] \"max_glu_serum\"            \"A1Cresult\"               \r\n[25] \"metformin\"                \"repaglinide\"             \r\n[27] \"nateglinide\"              \"chlorpropamide\"          \r\n[29] \"glimepiride\"              \"acetohexamide\"           \r\n[31] \"glipizide\"                \"glyburide\"               \r\n[33] \"tolbutamide\"              \"pioglitazone\"            \r\n[35] \"rosiglitazone\"            \"acarbose\"                \r\n[37] \"miglitol\"                 \"troglitazone\"            \r\n[39] \"tolazamide\"               \"examide\"                 \r\n[41] \"citoglipton\"              \"insulin\"                 \r\n[43] \"glyburide.metformin\"      \"glipizide.metformin\"     \r\n[45] \"glimepiride.pioglitazone\" \"metformin.rosiglitazone\" \r\n[47] \"metformin.pioglitazone\"   \"change\"                  \r\n[49] \"diabetesMed\"              \"readmitted\"              \r\n\r\n# check classes of column\r\nsapply(df, class)\r\n\r\n\r\n            encounter_id              patient_nbr \r\n               \"integer\"                \"integer\" \r\n                    race                   gender \r\n             \"character\"              \"character\" \r\n                     age                   weight \r\n             \"character\"              \"character\" \r\n       admission_type_id discharge_disposition_id \r\n               \"integer\"                \"integer\" \r\n     admission_source_id         time_in_hospital \r\n               \"integer\"                \"integer\" \r\n              payer_code        medical_specialty \r\n             \"character\"              \"character\" \r\n      num_lab_procedures           num_procedures \r\n               \"integer\"                \"integer\" \r\n         num_medications        number_outpatient \r\n               \"integer\"                \"integer\" \r\n        number_emergency         number_inpatient \r\n               \"integer\"                \"integer\" \r\n                  diag_1                   diag_2 \r\n             \"character\"              \"character\" \r\n                  diag_3         number_diagnoses \r\n             \"character\"                \"integer\" \r\n           max_glu_serum                A1Cresult \r\n             \"character\"              \"character\" \r\n               metformin              repaglinide \r\n             \"character\"              \"character\" \r\n             nateglinide           chlorpropamide \r\n             \"character\"              \"character\" \r\n             glimepiride            acetohexamide \r\n             \"character\"              \"character\" \r\n               glipizide                glyburide \r\n             \"character\"              \"character\" \r\n             tolbutamide             pioglitazone \r\n             \"character\"              \"character\" \r\n           rosiglitazone                 acarbose \r\n             \"character\"              \"character\" \r\n                miglitol             troglitazone \r\n             \"character\"              \"character\" \r\n              tolazamide                  examide \r\n             \"character\"              \"character\" \r\n             citoglipton                  insulin \r\n             \"character\"              \"character\" \r\n     glyburide.metformin      glipizide.metformin \r\n             \"character\"              \"character\" \r\nglimepiride.pioglitazone  metformin.rosiglitazone \r\n             \"character\"              \"character\" \r\n  metformin.pioglitazone                   change \r\n             \"character\"              \"character\" \r\n             diabetesMed               readmitted \r\n             \"character\"              \"character\" \r\n\r\n# exclude columns with identifiers and diagnosis codes\r\ndrops <- c(\"encounter_id\", \"patient_nbr\",\"admission_type_id\",\r\n           \"discharge_disposition_id\",\"admission_source_id\",\"payer_code\",\r\n           \"diag_1\",\"diag_2\",\"diag_3\")\r\ninput <- df[,!(colnames(df) %in% drops)]\r\n\r\n# which column has all same value\r\nfor (i in colnames(input)){\r\n  if (length(names(table(input[i])))==1){\r\n    print(i)\r\n  }\r\n}\r\n\r\n\r\n[1] \"examide\"\r\n[1] \"citoglipton\"\r\n\r\ninput$citoglipton <- NULL\r\ninput$examide <- NULL\r\n\r\n# replace no meaning cells with NA\r\ninput[input==\"?\"] <- NA\r\ninput[input==\"None\"] <- NA\r\ninput[input==\"Unknown/Invalid\"] <- NA\r\n\r\n# categorise\r\ninput <- input %>% mutate(across(starts_with(\"num\")|\r\n                                   starts_with(\"time_in_\"),\r\n                                 function (x) cut(x, 5)))\r\ninput.sub <- input\r\nsapply(input.sub, class)\r\n\r\n\r\n                    race                   gender \r\n             \"character\"              \"character\" \r\n                     age                   weight \r\n             \"character\"              \"character\" \r\n        time_in_hospital        medical_specialty \r\n                \"factor\"              \"character\" \r\n      num_lab_procedures           num_procedures \r\n                \"factor\"                 \"factor\" \r\n         num_medications        number_outpatient \r\n                \"factor\"                 \"factor\" \r\n        number_emergency         number_inpatient \r\n                \"factor\"                 \"factor\" \r\n        number_diagnoses            max_glu_serum \r\n                \"factor\"              \"character\" \r\n               A1Cresult                metformin \r\n             \"character\"              \"character\" \r\n             repaglinide              nateglinide \r\n             \"character\"              \"character\" \r\n          chlorpropamide              glimepiride \r\n             \"character\"              \"character\" \r\n           acetohexamide                glipizide \r\n             \"character\"              \"character\" \r\n               glyburide              tolbutamide \r\n             \"character\"              \"character\" \r\n            pioglitazone            rosiglitazone \r\n             \"character\"              \"character\" \r\n                acarbose                 miglitol \r\n             \"character\"              \"character\" \r\n            troglitazone               tolazamide \r\n             \"character\"              \"character\" \r\n                 insulin      glyburide.metformin \r\n             \"character\"              \"character\" \r\n     glipizide.metformin glimepiride.pioglitazone \r\n             \"character\"              \"character\" \r\n metformin.rosiglitazone   metformin.pioglitazone \r\n             \"character\"              \"character\" \r\n                  change              diabetesMed \r\n             \"character\"              \"character\" \r\n              readmitted \r\n             \"character\" \r\n\r\ninput.sub <- input.sub %>%\r\n  mutate_if(is.character, as.factor) %>%\r\n  mutate_if(is.integer, as.factor) %>%\r\n  mutate_if(is.factor, droplevels)\r\n              \r\n# column containing NAs\r\nfor (i in colnames(input.sub)){\r\n  if (length(names(table(is.na(input.sub[i]))))!=1){\r\n    print(i)\r\n    print(table(is.na(input.sub[i])))\r\n  }\r\n}\r\n\r\n\r\n[1] \"race\"\r\n\r\nFALSE  TRUE \r\n99493  2273 \r\n[1] \"gender\"\r\n\r\n FALSE   TRUE \r\n101763      3 \r\n[1] \"weight\"\r\n\r\nFALSE  TRUE \r\n 3197 98569 \r\n[1] \"medical_specialty\"\r\n\r\nFALSE  TRUE \r\n51817 49949 \r\n[1] \"max_glu_serum\"\r\n\r\nFALSE  TRUE \r\n 5346 96420 \r\n[1] \"A1Cresult\"\r\n\r\nFALSE  TRUE \r\n17018 84748 \r\n\r\n\r\n\r\ndag = structural.em(x=input.sub, maximize=\"hc\", return.all = TRUE)\r\ndag.plot = as.igraph(dag$dag)\r\n# Delete zero degree nodes for plot\r\ndelG <- delete.vertices(dag.plot, igraph::degree(dag.plot)==0)\r\nrawPlot <- ggraph(delG) +\r\n  geom_node_point() +\r\n  geom_edge_diagonal(arrow = arrow(length=unit(2, 'mm')),\r\n                     end_cap=circle(2, 'mm')) +\r\n  geom_node_text(aes_(label=~name), check_overlap=TRUE,\r\n                 repel=TRUE, color = \"white\",\r\n                 bg.color = \"black\", segment.color=\"black\",\r\n                 bg.r = .15) +\r\n  theme_graph()\r\n\r\n\r\n\r\nUsing ggraph.\r\n\r\n\r\nrawPlot\r\n\r\n\r\n\r\n\r\nUsing bnviewer.\r\n\r\n\r\nviewer(as.bn(delG))\r\n\r\n\r\n\r\n{\"x\":{\"nodes\":{\"id\":[\"race\",\"gender\",\"age\",\"weight\",\"time_in_hospital\",\"medical_specialty\",\"num_lab_procedures\",\"num_procedures\",\"num_medications\",\"number_inpatient\",\"number_diagnoses\",\"max_glu_serum\",\"A1Cresult\",\"metformin\",\"repaglinide\",\"nateglinide\",\"chlorpropamide\",\"glimepiride\",\"glipizide\",\"glyburide\",\"tolbutamide\",\"pioglitazone\",\"rosiglitazone\",\"acarbose\",\"insulin\",\"glyburide.metformin\",\"change\",\"diabetesMed\",\"readmitted\"],\"label\":[\" race\",\" gender\",\" age\",\" weight\",\" time_in_hospital\",\" medical_specialty\",\" num_lab_procedures\",\" num_procedures\",\" num_medications\",\" number_inpatient\",\" number_diagnoses\",\" max_glu_serum\",\" A1Cresult\",\" metformin\",\" repaglinide\",\" nateglinide\",\" chlorpropamide\",\" glimepiride\",\" glipizide\",\" glyburide\",\" tolbutamide\",\" pioglitazone\",\" rosiglitazone\",\" acarbose\",\" insulin\",\" glyburide.metformin\",\" change\",\" diabetesMed\",\" readmitted\"]},\"edges\":{\"from\":[\"insulin\",\"insulin\",\"metformin\",\"time_in_hospital\",\"metformin\",\"glipizide\",\"glyburide\",\"glipizide\",\"num_medications\",\"glyburide\",\"time_in_hospital\",\"num_procedures\",\"age\",\"num_medications\",\"change\",\"number_diagnoses\",\"change\",\"race\",\"diabetesMed\",\"num_lab_procedures\",\"insulin\",\"insulin\",\"diabetesMed\",\"metformin\",\"diabetesMed\",\"glipizide\",\"number_diagnoses\",\"age\",\"age\",\"glipizide\",\"change\",\"insulin\",\"diabetesMed\",\"glyburide\",\"number_diagnoses\",\"metformin\",\"readmitted\",\"diabetesMed\",\"diabetesMed\",\"pioglitazone\",\"time_in_hospital\",\"insulin\",\"num_lab_procedures\",\"num_medications\",\"race\",\"insulin\",\"diabetesMed\",\"change\",\"change\",\"metformin\",\"insulin\",\"change\",\"diabetesMed\",\"diabetesMed\"],\"to\":[\"change\",\"diabetesMed\",\"change\",\"num_medications\",\"diabetesMed\",\"change\",\"change\",\"diabetesMed\",\"num_procedures\",\"diabetesMed\",\"num_lab_procedures\",\"medical_specialty\",\"number_diagnoses\",\"insulin\",\"pioglitazone\",\"time_in_hospital\",\"rosiglitazone\",\"age\",\"glimepiride\",\"A1Cresult\",\"pioglitazone\",\"rosiglitazone\",\"pioglitazone\",\"glyburide\",\"rosiglitazone\",\"glyburide\",\"num_medications\",\"metformin\",\"gender\",\"glimepiride\",\"glimepiride\",\"glimepiride\",\"repaglinide\",\"insulin\",\"readmitted\",\"glipizide\",\"number_inpatient\",\"glyburide.metformin\",\"nateglinide\",\"rosiglitazone\",\"num_procedures\",\"max_glu_serum\",\"max_glu_serum\",\"num_lab_procedures\",\"gender\",\"weight\",\"readmitted\",\"repaglinide\",\"acarbose\",\"pioglitazone\",\"repaglinide\",\"nateglinide\",\"chlorpropamide\",\"tolbutamide\"],\"smooth\":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],\"dashes\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"font.size\":[18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],\"font.color\":[\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\",\"black\"],\"shadow\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\"},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"to\"},\"layout\":{\"randomSeed\":123}},\"groups\":null,\"width\":\"100%\",\"height\":\"500px\",\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;\"},\"footer\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;\"},\"background\":null,\"iconsRedraw\":true,\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"}},\"evals\":[],\"jsHooks\":[]}\r\nBootstrap-based inference and plotting.\r\n\r\n\r\nimp <- dag$imputed\r\n\r\n# construct bootstrapped network\r\ncl = makeCluster(4)\r\nstr.diff = boot.strength(imp, R = 100, algorithm = \"hc\", cluster = cl)\r\navg.diff = averaged.network(str.diff)\r\n\r\navg.plot = as.igraph(avg.diff)\r\n# Delete zero degree nodes for plot\r\ndelAv <- delete.vertices(avg.plot, igraph::degree(avg.plot)==0)\r\n\r\nstr.diff = subset(str.diff, str.diff$from %in% names(V(delAv)))\r\nstr.diff = subset(str.diff, str.diff$to %in% names(V(delAv)))\r\n\r\nstrength.viewer(\r\n  as.bn(delAv),\r\n  str.diff,\r\n  bayesianNetwork.arc.strength.label = TRUE,\r\n  bayesianNetwork.edge.scale.min = 1,\r\n  bayesianNetwork.edge.scale.max = 3,\r\n  bayesianNetwork.edge.scale.label.min = 14,\r\n  bayesianNetwork.edge.scale.label.max = 14,\r\n  bayesianNetwork.layout = \"layout_with_sugiyama\"\r\n)\r\n\r\n\r\n\r\n{\"x\":{\"nodes\":{\"id\":[\"race\",\"gender\",\"age\",\"weight\",\"time_in_hospital\",\"medical_specialty\",\"num_lab_procedures\",\"num_procedures\",\"num_medications\",\"number_inpatient\",\"number_diagnoses\",\"max_glu_serum\",\"A1Cresult\",\"metformin\",\"repaglinide\",\"nateglinide\",\"chlorpropamide\",\"glimepiride\",\"glipizide\",\"glyburide\",\"tolbutamide\",\"pioglitazone\",\"rosiglitazone\",\"acarbose\",\"insulin\",\"glyburide.metformin\",\"change\",\"diabetesMed\",\"readmitted\"],\"label\":[\" race\",\" gender\",\" age\",\" weight\",\" time_in_hospital\",\" medical_specialty\",\" num_lab_procedures\",\" num_procedures\",\" num_medications\",\" number_inpatient\",\" number_diagnoses\",\" max_glu_serum\",\" A1Cresult\",\" metformin\",\" repaglinide\",\" nateglinide\",\" chlorpropamide\",\" glimepiride\",\" glipizide\",\" glyburide\",\" tolbutamide\",\" pioglitazone\",\" rosiglitazone\",\" acarbose\",\" insulin\",\" glyburide.metformin\",\" change\",\" diabetesMed\",\" readmitted\"],\"x\":[-1,-0.947368421052632,-0.473684210526316,-0.526315789473684,-0.684210526315789,-0.947368421052632,-0.526315789473684,-0.947368421052632,-0.263157894736842,-0.631578947368421,-0.473684210526316,-0.105263157894737,-0.736842105263158,0.263157894736842,1,-0.421052631578947,-0.315789473684211,0.578947368421053,0.368421052631579,0.368421052631579,-0.526315789473684,0.210526315789474,0.105263157894737,0.684210526315789,0.263157894736842,-0.105263157894737,0.421052631578947,-0.210526315789474,-0.631578947368421],\"y\":[-0.714285714285714,-0.428571428571429,-1,0.428571428571429,-0.428571428571429,0.428571428571429,0.142857142857143,0.142857142857143,-0.142857142857143,1,-0.714285714285714,0.428571428571429,0.428571428571429,-0.714285714285714,0.714285714285714,0.714285714285714,0.714285714285714,0.714285714285714,-0.428571428571429,-0.142857142857143,0.714285714285714,0.714285714285714,1,0.714285714285714,0.142857142857143,0.714285714285714,0.428571428571429,0.428571428571429,0.714285714285714]},\"edges\":{\"from\":[\"race\",\"gender\",\"age\",\"age\",\"age\",\"age\",\"time_in_hospital\",\"time_in_hospital\",\"time_in_hospital\",\"num_lab_procedures\",\"num_lab_procedures\",\"num_procedures\",\"num_medications\",\"num_medications\",\"num_medications\",\"number_diagnoses\",\"number_diagnoses\",\"number_diagnoses\",\"number_diagnoses\",\"metformin\",\"metformin\",\"metformin\",\"metformin\",\"metformin\",\"metformin\",\"glipizide\",\"glipizide\",\"glipizide\",\"glipizide\",\"glyburide\",\"glyburide\",\"glyburide\",\"pioglitazone\",\"insulin\",\"insulin\",\"insulin\",\"insulin\",\"insulin\",\"insulin\",\"insulin\",\"insulin\",\"change\",\"change\",\"change\",\"change\",\"change\",\"change\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"diabetesMed\",\"readmitted\"],\"to\":[\"gender\",\"race\",\"race\",\"gender\",\"number_diagnoses\",\"metformin\",\"num_lab_procedures\",\"num_procedures\",\"num_medications\",\"max_glu_serum\",\"A1Cresult\",\"medical_specialty\",\"num_lab_procedures\",\"num_procedures\",\"insulin\",\"age\",\"time_in_hospital\",\"num_medications\",\"readmitted\",\"age\",\"glipizide\",\"glyburide\",\"pioglitazone\",\"change\",\"diabetesMed\",\"glimepiride\",\"glyburide\",\"change\",\"diabetesMed\",\"insulin\",\"change\",\"diabetesMed\",\"rosiglitazone\",\"weight\",\"max_glu_serum\",\"repaglinide\",\"glimepiride\",\"pioglitazone\",\"rosiglitazone\",\"change\",\"diabetesMed\",\"repaglinide\",\"nateglinide\",\"glimepiride\",\"pioglitazone\",\"rosiglitazone\",\"acarbose\",\"repaglinide\",\"nateglinide\",\"chlorpropamide\",\"glimepiride\",\"tolbutamide\",\"pioglitazone\",\"rosiglitazone\",\"glyburide.metformin\",\"readmitted\",\"number_inpatient\"],\"smooth\":[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true],\"dashes\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],\"value\":[1,1,1,1,1,1,1,0.83,1,1,1,1,0.74,1,1,1,1,1,1,1,1,1,1,1,1,0.9,1,1,1,0.97,1,1,1,0.84,0.99,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.97,1,0.57,1,1,1,0.72,1],\"width\":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"label\":[\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 0.83\",\" 1\",\" 1\",\" 1\",\" 1\",\" 0.74\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 0.9\",\" 1\",\" 1\",\" 1\",\" 0.97\",\" 1\",\" 1\",\" 1\",\" 0.84\",\" 0.99\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 1\",\" 0.97\",\" 1\",\" 0.57\",\" 1\",\" 1\",\" 1\",\" 0.72\",\" 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"to\",\"color\":[],\"scaling\":{\"min\":1,\"max\":3,\"label\":{\"enabled\":true,\"min\":14,\"max\":14}},\"smooth\":false},\"physics\":{\"stabilization\":false}},\"groups\":null,\"width\":\"100%\",\"height\":\"500px\",\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;\"},\"submain\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;\"},\"footer\":{\"text\":\"\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-size:12px;text-align:center;\"},\"background\":null,\"iconsRedraw\":true,\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-06-01-dmbn/distill-preview.png",
    "last_modified": "2021-10-22T13:15:09+09:00",
    "input_file": {}
  }
]
